<%- include('../partials/dashboardheader.ejs') %> 

<div class="content">
	<div class="container-xl">
		<!-- Page title -->
		<div class="page-header d-print-none">
			<div class="row align-items-center">
				<div class="col">
					<h2 class="page-title">Configuration</h2>
					<div class="text-muted mt-1">
						Basic app settings
					</div>
				</div>


			<!-- Page title actions -->
			<div class="col-auto ms-auto d-print-none">
            <div class="btn-list">
				<%if(levels.length > 0){%>
                <span class="d-none d-sm-inline">
                    <a href="#" data-bs-toggle="modal" data-bs-target="#modal_new_level" class="btn btn-white d-none d-sm-inline-block"
                    >
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24"
                        stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                        <line x1="12" y1="5" x2="12" y2="19" />
                        <line x1="5" y1="12" x2="19" y2="12" />
                    </svg>
                    Add New Level
                </a>
                </span>
				<%}%>
				<%if(campuses.length > 0){%>
                <a href="#" data-bs-toggle="modal" data-bs-target="#modal_new_campus" class="btn btn-primary d-none d-sm-inline-block"
                    >
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24"
                        stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                        <line x1="12" y1="5" x2="12" y2="19" />
                        <line x1="5" y1="12" x2="19" y2="12" />
                    </svg>
                    Add New Campus
                </a>
              <%}%>
            </div>
        	</div>


			</div>
		</div>

        <div class="row row-cards">
			
			<%if(levels.length > 0){%>
			<div class="col-md-6 col-lg-4">
              <div class="card">
                <div class="card-header">
                  <h3 class="card-title">Levels</h3>
                </div>
                <table class="table card-table table-vcenter">
                  <thead>
                    <tr>
                      <th>Name</th>
                      <th colspan="2">Value</th>
                    </tr>
                  </thead>
                  <tbody>
					  <%for(var level of levels){%>
                    <tr>
                      <td><%=level.name %></td>
                      <td><%=level.value %></td>
                      <td class="w-50">
                        <div class="progress progress-xs">
                          <div class="progress-bar bg-primary" style="width: <%=progress(level.value, levels)%>"></div>
                        </div>
                      </td>
                    </tr>
                    
                    <%}%>
                  
                  </tbody>
                </table>
              </div>
            </div>

<%}else{%>
	<div class="col-md-6 col-lg-4">
                  <div class="card">
                    <div class="empty">
                      <div class="empty-img"><img src="/static/illustrations/undraw_quitting_time_dm8t.svg" height="128"  alt="">
                      </div>
                      <p class="empty-title">No results found</p>
                      <p class="empty-subtitle text-muted">
                        Try adjusting your search or filter to find what you're looking for.
                      </p>
                      <div class="empty-action">
                        <a href="#" data-bs-toggle="modal" data-bs-target="#modal_new_level" class="btn btn-primary">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><line x1="12" y1="5" x2="12" y2="19" /><line x1="5" y1="12" x2="19" y2="12" /></svg>
                        Add new Level
                        </a>
                      </div>
                    </div>
                  </div>
    </div>
	
<%}%>
			

			
<%if(campuses.length > 0){%>
<div class="col-md-12 col-lg-8">
              <div class="card">
                <div class="card-header">
                  <h3 class="card-title">Campuses</h3>
                </div>
                <div class="table-responsive">
                  <table class="table card-table table-vcenter">

					<%for(var campus of campuses){%>
                    <tr>
                     	<td class="w-100">
                        <a href="#" class="text-reset"><%=campus.name%></a>
                      </td>
                      <td class="text-nowrap text-muted">
                       <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="12" cy="11" r="3" /><path d="M17.657 16.657l-4.243 4.243a2 2 0 0 1 -2.827 0l-4.244 -4.243a8 8 0 1 1 11.314 0z" /></svg>
                        <%=campus.location%>
                      </td>
                      <td class="text-nowrap">
                        <a href="#" class="text-muted">
                          <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><rect x="4" y="5" width="16" height="16" rx="2" /><line x1="16" y1="3" x2="16" y2="7" /><line x1="8" y1="3" x2="8" y2="7" /><line x1="4" y1="11" x2="20" y2="11" /><rect x="8" y="15" width="2" height="2" /></svg>
                          <%=moment(campus.createdAt).format('LLLL')%>
                        </a>
                      </td>
                      
                      <td>
                         <a href="#modal_campus_edit" class="nav-link" title="Edit" data-bs-toggle="tab"><svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10.325 4.317c.426 -1.756 2.924 -1.756 3.35 0a1.724 1.724 0 0 0 2.573 1.066c1.543 -.94 3.31 .826 2.37 2.37a1.724 1.724 0 0 0 1.065 2.572c1.756 .426 1.756 2.924 0 3.35a1.724 1.724 0 0 0 -1.066 2.573c.94 1.543 -.826 3.31 -2.37 2.37a1.724 1.724 0 0 0 -2.572 1.065c-.426 1.756 -2.924 1.756 -3.35 0a1.724 1.724 0 0 0 -2.573 -1.066c-1.543 .94 -3.31 -.826 -2.37 -2.37a1.724 1.724 0 0 0 -1.065 -2.572c-1.756 -.426 -1.756 -2.924 0 -3.35a1.724 1.724 0 0 0 1.066 -2.573c-.94 -1.543 .826 -3.31 2.37 -2.37c1 .608 2.296 .07 2.572 -1.065z" /><circle cx="12" cy="12" r="3" /></svg>
                      </td>
                    </tr>      
					<%}%>
					
                  </table>
                </div>
              </div>
</div>
<%}else{%>
<div class="col-md-6 col-lg-8">
                  <div class="card">
                    <div class="empty">
                      <div class="empty-img"><img src="/static/illustrations/undraw_quitting_time_dm8t.svg" height="128"  alt="">
                      </div>
                      <p class="empty-title">No results found</p>
                      <p class="empty-subtitle text-muted">
                        Try adjusting your search or filter to find what you're looking for.
                      </p>
                      <div class="empty-action">
                        <a href="#" data-bs-toggle="modal" data-bs-target="#modal_new_campus" class="btn btn-primary">
                                          <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><line x1="12" y1="5" x2="12" y2="19" /><line x1="5" y1="12" x2="19" y2="12" /></svg>
                          Add new campus
                        </a>
                      </div>
                    </div>
                  </div>
                </div>
<%}%>
			

        </div>
</div>
</div>





<div class="modal modal-blur fade" id="modal_new_campus" tabindex="-1" role="dialog" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Create New Campus</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="campusForm">
						<div class="form-group mb-3 row">
								<label class="form-label col-3 col-form-label"
									>Campus Name</label
								>
								<div class="col">
									<input
										type="text"
										class="form-control"
										aria-describedby="emailHelp"
										placeholder="Provide campus name"
                                        id="name"
									/>
									<small class="form-hint"
										>We'll never share your email with anyone
										else.</small
									>
								</div>
							</div>
							<div class="form-group mb-3 row">
								<label class="form-label col-3 col-form-label"
									>Location</label>
								
								<div class="col">
									<input
										type="text"
										class="form-control"
										aria-describedby="emailHelp"
										placeholder="Where is this campus"
                                        id="location"
									/>
									<small class="form-hint"
										>We'll never share your email with anyone
										else.</small
									>
								</div>
							</div>
							
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn me-auto" data-bs-dismiss="modal">Close</button>
            <button type="submit" class="btn btn-primary" form="campusForm">Add Campus</button>
          </div>
        </div>
      </div>
</div>

<div class="modal modal-blur fade" id="modal_new_level" tabindex="-1" role="dialog" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Create New Level</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="levelForm">
						<div class="form-group mb-3 row">
								<label class="form-label col-3 col-form-label"
									>Level Name</label
								>
								<div class="col">
									<input
										type="text"
										class="form-control"
										aria-describedby="emailHelp"
										placeholder="Provide campus name"
                                        id="level_name"
									/>
									<small class="form-hint"
										>We'll never share your email with anyone
										else.</small
									>
								</div>
							</div>
							<div class="form-group mb-3 row">
								<label class="form-label col-3 col-form-label"
									>Level Value</label>
								
								<div class="col">
									<input
										type="text"
										class="form-control"
										aria-describedby="emailHelp"
										placeholder="Where is this campus"
                                        id="level_value"
									/>
									<small class="form-hint"
										>We'll never share your email with anyone
										else.</small
									>
								</div>
							</div>
							
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn me-auto" data-bs-dismiss="modal">Close</button>
            <button type="submit" form="levelForm" class="btn btn-primary" >Add Level</button>
          </div>
        </div>
      </div>
</div>

<script type="text/javascript">
	const campusForm = document.getElementById("campusForm");
	const levelForm = document.getElementById("levelForm");

	campusForm.addEventListener("submit", async event => {
		event.preventDefault();

		const name = document.getElementById("name");
		const location = document.getElementById("location");
	

		let data = new FormData();

		data.append("name", name.value);
		data.append("location", location.value);

		console.log({name: name.value, location: location.value, });

		const saveCampus = await fetch(`/campus/new`, {
			method: "POST",
			headers: {
				"Content-Type": "application/json"
			},
			body: JSON.stringify({location: location.value, name: name.value}),
		}).then(response => response.json());


	});


		levelForm.addEventListener("submit", async event => {
		event.preventDefault();

		const name = document.getElementById("level_name");
		const value = document.getElementById("level_value");
	

		let data = new FormData();

		data.append("name", name.value);
		data.append("value", value.value);

		console.log({name: name.value, value: value.value, });

		const saveLevel = await fetch(`/level/new`, {
			method: "POST",
			headers: {
				"Content-Type": "application/json"
			},
			body: JSON.stringify({value: value.value, name: name.value}),
		}).then(response => response.json());


	});
</script>